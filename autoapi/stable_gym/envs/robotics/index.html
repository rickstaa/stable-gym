<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>stable_gym.envs.robotics &mdash; Stable Gym 0.20.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/modify.css?v=519ed47b" />

  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=068042d4"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="stable_gym.envs.robotics.fetch" href="fetch/index.html" />
    <link rel="prev" title="stable_gym.envs.mujoco.walker2d_cost.walker2d_cost" href="../mujoco/walker2d_cost/walker2d_cost/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html">
            
              <img src="../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.20.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../get_started/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../get_started/usage.html">How to use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../envs/envs.html">Environments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/contributing.html">Contribute to stable-gym</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/add_new_envs.html">Add new environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/doc_dev.html">Build the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../common/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.common</span></code></a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Stable Gym</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym</span></code></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs</span></code></a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics</span></code></li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/rickstaa/stable-gym/blob/main/docs/source/autoapi/stable_gym/envs/robotics/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-stable_gym.envs.robotics">
<span id="stable-gym-envs-robotics"></span><h1><a class="reference internal" href="#module-stable_gym.envs.robotics" title="stable_gym.envs.robotics"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics</span></code></a><a class="headerlink" href="#module-stable_gym.envs.robotics" title="Permalink to this heading"></a></h1>
<p>Stable Gym gymnasium environments that are based on robotics environments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some of these environments are based on the <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.GoalEnv</span></code> class. This means
that the <code class="docutils literal notranslate"><span class="pre">step</span></code> method returns a dictionary with the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">observation</span></code>: The observation of the environment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">achieved_goal</span></code>: The goal that was achieved during execution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">desired_goal</span></code>: The desired goal that we asked the agent to attempt to achieve.</p></li>
</ul>
<p>If you want to use these environments with RL algorithms that expect the <code class="docutils literal notranslate"><span class="pre">step</span></code>
method to return a <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code> instead of a dictionary, you can use the
<code class="xref py py-class docutils literal notranslate"><span class="pre">gym.wrappers.FlattenObservation</span></code> wrapper to flatten the dictionary into a
single <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>.</p>
</div>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="fetch/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.fetch</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="fetch/fetch_reach_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.fetch.fetch_reach_cost</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="fetch/fetch_reach_cost/fetch_reach_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.fetch.fetch_reach_cost.fetch_reach_cost</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="minitaur/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.minitaur</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="minitaur/minitaur_bullet_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.minitaur.minitaur_bullet_cost</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="minitaur/minitaur_bullet_cost/minitaur_bullet_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.minitaur.minitaur_bullet_cost.minitaur_bullet_cost</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quadrotor/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.quadrotor</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="quadrotor/quadx_hover_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.quadrotor.quadx_hover_cost</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="quadrotor/quadx_hover_cost/quadx_hover_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.quadrotor.quadx_hover_cost.quadx_hover_cost</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quadrotor/quadx_tracking_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.quadrotor.quadx_tracking_cost</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="quadrotor/quadx_tracking_cost/quadx_tracking_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.quadrotor.quadx_tracking_cost.quadx_tracking_cost</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quadrotor/quadx_waypoints_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.quadrotor.quadx_waypoints_cost</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="quadrotor/quadx_waypoints_cost/quadx_waypoints_cost/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_gym.envs.robotics.quadrotor.quadx_waypoints_cost.quadx_waypoints_cost</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Permalink to this heading"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#stable_gym.envs.robotics.FetchReachCost" title="stable_gym.envs.robotics.FetchReachCost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FetchReachCost</span></code></a></p></td>
<td><p>Custom FetchReach gymnasium robotics environment.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stable_gym.envs.robotics.MinitaurBulletCost" title="stable_gym.envs.robotics.MinitaurBulletCost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MinitaurBulletCost</span></code></a></p></td>
<td><p>Custom Minitaur Bullet gymnasium environment.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stable_gym.envs.robotics.QuadXHoverCost" title="stable_gym.envs.robotics.QuadXHoverCost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuadXHoverCost</span></code></a></p></td>
<td><p>Custom QuadXHover Bullet gymnasium environment.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stable_gym.envs.robotics.QuadXTrackingCost" title="stable_gym.envs.robotics.QuadXTrackingCost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuadXTrackingCost</span></code></a></p></td>
<td><p>Custom QuadX Bullet gymnasium environment.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stable_gym.envs.robotics.QuadXWaypointsCost" title="stable_gym.envs.robotics.QuadXWaypointsCost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuadXWaypointsCost</span></code></a></p></td>
<td><p>Custom QuadXWaypoints Bullet gymnasium environment.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_gym.envs.robotics.</span></span><span class="sig-name descname"><span class="pre">FetchReachCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/fetch/fetch_reach_cost/fetch_reach_cost.html#FetchReachCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">gymnasium_robotics.envs.fetch.reach.MujocoFetchReachEnv</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">gymnasium.utils.EzPickle</span></code></p>
<p>Custom FetchReach gymnasium robotics environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used in a vectorized manner. See the
<a class="reference external" href="https://gymnasium.farama.org/api/vector">gym.vector</a> documentation.</p>
</div>
<dl>
<dt>Source:</dt><dd><p>Modified version of the FetchReach Mujoco environment found in the
<a class="reference external" href="https://robotics.farama.org/envs/fetch/">Gymnasium Robotics library</a>.
This modification was first described by
<a class="reference external" href="https://arxiv.org/abs/2004.14288">Han et al. 2020</a>. In this modified version:</p>
<ul class="simple">
<li><p>The reward was replaced with a cost. This was done by taking the absolute
value of the reward.</p></li>
</ul>
<p>The rest of the environment is the same as the original FetchReach environment.
Below, the modified cost is described. For more information about the
environment (e.g. observation space, action space, episode termination, etc.),
please refer to the
<a class="reference external" href="https://robotics.farama.org/envs/fetch/reach/">gymnasium robotics library</a>.</p>
</dd>
<dt>Modified cost:</dt><dd><p>A cost, computed using the <a class="reference internal" href="#stable_gym.envs.robotics.FetchReachCost.cost" title="stable_gym.envs.robotics.FetchReachCost.cost"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FetchReachCost.cost()</span></code></a> method, is given for each
simulation step, including the terminal step. This cost is defined as the error
between FetchReach’s end-effector position and the desired goal position (i.e. Euclidean distance).
The cost is computed as:</p>
<div class="math notranslate nohighlight">
\[cost = \left | reward \right |\]</div>
</dd>
<dt>Solved Requirements:</dt><dd><p>Considered solved when the average cost is less than or equal to 50 over
100 consecutive trials.</p>
</dd>
<dt>How to use:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stable_gyms</span>
<span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;stable_gym:FetchReachCost-v1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost.state">
<span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost.state" title="Permalink to this definition"></a></dt>
<dd><p>The current system state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost.dt">
<span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost.dt" title="Permalink to this definition"></a></dt>
<dd><p>The environment step size. Also available as <a class="reference internal" href="#stable_gym.envs.robotics.FetchReachCost.tau" title="stable_gym.envs.robotics.FetchReachCost.tau"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tau</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Accepts all arguments of the original <code class="xref py py-class docutils literal notranslate"><span class="pre">MujocoFetchReachEnv</span></code>
class except for the <code class="docutils literal notranslate"><span class="pre">reward_type</span></code> argument. This is because we require dense
rewards to calculate the cost.</p>
</div>
<p>Initialise a new FetchReachCost environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type of the
action space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float32</span></code>.</p></li>
<li><p><strong>observation_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type
of the observation space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to the original
<code class="xref py py-class docutils literal notranslate"><span class="pre">MujocoFetchReachEnv</span></code> class.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost.tau">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost.tau" title="Permalink to this definition"></a></dt>
<dd><p>Alias for the environment step size. Done for compatibility with the
other gymnasium environments.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost.t">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t</span></span><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost.t" title="Permalink to this definition"></a></dt>
<dd><p>Environment time.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost.physics_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physics_time</span></span><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost.physics_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns the physics time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reward</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/fetch/fetch_reach_cost/fetch_reach_cost.html#FetchReachCost.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost.cost" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the cost.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>reward</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The reward returned from the FetchReach environment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cost (i.e. negated reward).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/fetch/fetch_reach_cost/fetch_reach_cost.html#FetchReachCost.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost.step" title="Permalink to this definition"></a></dt>
<dd><p>Take step into the environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method overrides the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code> method
such that the new cost function is used.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>np.ndarray</em>) – Action to take in the environment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): Environment observation.</p></li>
<li><p>cost (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): Cost of the action.</p></li>
<li><p>terminated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode is terminated.</p></li>
<li><p>truncated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode was truncated. This
value is set by wrappers when for example a time limit is reached or
the agent goes out of bounds.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Additional information about the environment.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.FetchReachCost.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/fetch/fetch_reach_cost/fetch_reach_cost.html#FetchReachCost.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.FetchReachCost.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset gymnasium environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – A random seed for the environment. By default
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary containing additional options for
resetting the environment. By default <code class="docutils literal notranslate"><span class="pre">None</span></code>. Not used in this
environment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>): Initial environment observation.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Dictionary containing additional information.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_gym.envs.robotics.</span></span><span class="sig-name descname"><span class="pre">MinitaurBulletCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_forward_velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomise_reference_forward_velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomise_reference_forward_velocity_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">1.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_velocity_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_energy_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_shake_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shake_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_drift_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">float('inf')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_health_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">health_penalty_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_velocity_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fall_criteria_up_rotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fall_criteria_z_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_reference_from_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_reference_error_from_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_x_velocity_from_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/minitaur/minitaur_bullet_cost/minitaur_bullet_cost.html#MinitaurBulletCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">pybullet_envs.bullet.minitaur_gym_env.MinitaurBulletEnv</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">gymnasium.utils.EzPickle</span></code></p>
<p>Custom Minitaur Bullet gymnasium environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used in a vectorized manner. See the
<a class="reference external" href="https://gymnasium.farama.org/api/vector">gym.vector</a> documentation.</p>
</div>
<dl>
<dt>Source:</dt><dd><p>Modified version of the <a class="reference external" href="https://arxiv.org/abs/1804.10332">Minitaur environment</a> found in the
<a class="reference external" href="https://pybullet.org/">pybullet package</a>. This modification was first described by
<a class="reference external" href="https://arxiv.org/abs/2004.14288">Han et al. 2020</a>. In this modified version:</p>
<ul class="simple">
<li><p>The objective was changed to a velocity-tracking task. To do this, the
reward is replaced with a cost. This cost is the squared difference between
the Minitaur’s forward velocity and a reference value (error). Additionally,
also a energy cost and health penalty can be included in the cost.</p></li>
<li><p>A minimal backward velocity bound is added to prevent the Minitaur from
walking backwards.</p></li>
<li><p>Users are given the option to modify the Minitaur fall criteria, and thus
the episode termination criteria.</p></li>
</ul>
<p>The rest of the environment is the same as the original Minitaur environment.
Please refer to the
<a class="reference external" href="https://github.com/bulletphysics/bullet3/tree/master/examples/pybullet/gym/pybullet_envs/bullet/minitaur_gym_env.py">original codebase</a>
or <a class="reference external" href="https://arxiv.org/abs/1804.10332">the article of Tan et al. 2018</a> on which the Minitaur environment is based for more information.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In <a class="reference external" href="https://arxiv.org/abs/2004.14288">Han et al. 2020</a>, the authors disabled the termination criteria. In our implementation, we have
kept them for consistency with the original Minitaur environment. The termination criteria can be
enabled by setting the <a href="#id1"><span class="problematic" id="id2">:arg:`fall_criteria_up_rotation`</span></a> and <a href="#id3"><span class="problematic" id="id4">:arg:`fall_criteria_z_position`</span></a> to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.inf</span></code>.</p>
</div>
</dd>
</dl>
<dl>
<dt>Observation:</dt><dd><p><strong>Type</strong>: Box(28)</p>
<p>Contains angles, velocities, and torques of all motors. Optionally, it can also include the reference, reference error, and x velocity.</p>
</dd>
<dt>Actions:</dt><dd><p><strong>Type</strong>: Box(8)</p>
<p>A list of desired motor angles for eight motors.</p>
</dd>
<dt>Modified cost:</dt><dd><p>A cost, computed using the <a class="reference internal" href="#stable_gym.envs.robotics.MinitaurBulletCost.cost" title="stable_gym.envs.robotics.MinitaurBulletCost.cost"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MinitaurBulletCost.cost()</span></code></a> method, is given for each
simulation step, including the terminal step. This cost is defined as the error
between the Minitaur’s forward velocity and a reference value. A control
cost and health penalty can also be included in the cost. This health penalty
equals the <code class="docutils literal notranslate"><span class="pre">max_episode_steps</span></code> minus the number of steps taken in the episode
or a fixed value. The cost is computed as:</p>
<div class="math notranslate nohighlight">
\[cost = w_{forward\_velocity} \times (x_{velocity} - x_{reference\_x\_velocity})^2 + w_{ctrl} \times c_{ctrl} + p_{health}\]</div>
</dd>
<dt>Starting State:</dt><dd><p>The robot always starts at the same position and orientation, with zero
velocity.</p>
</dd>
<dt>Episode Termination:</dt><dd><ul class="simple">
<li><p>The episode is terminated if the Minitaur falls, meaning that the
the orientation between the base and the world is greater than a threshold or
the base is too close to the ground.</p></li>
<li><p>Optionally, the episode can be terminated if the Minitaur walks backwards.</p></li>
</ul>
</dd>
<dt>Solved Requirements:</dt><dd><p>Considered solved when the average cost is less than or equal to 50 over
100 consecutive trials.</p>
</dd>
<dt>How to use:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stable_gym</span>
<span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;stable_gym:MinitaurBulletCost-v1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.state">
<span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.state" title="Permalink to this definition"></a></dt>
<dd><p>The current system state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.t">
<span class="sig-name descname"><span class="pre">t</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.t" title="Permalink to this definition"></a></dt>
<dd><p>The current environment time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.reference_forward_velocity">
<span class="sig-name descname"><span class="pre">reference_forward_velocity</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.reference_forward_velocity" title="Permalink to this definition"></a></dt>
<dd><p>The forward velocity that the agent should
try to track.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Since the <code class="xref py py-meth docutils literal notranslate"><span class="pre">MinitaurBulletEnv()</span></code>
is not yet compatible with <a class="reference external" href="https://gymnasium.farama.org/">gymnasium v&gt;=0.26.0</a>, the
<code class="xref py py-class docutils literal notranslate"><span class="pre">gym.wrappers.EnvCompatibility</span></code> wrapper is used. This has the
side effect that the <code class="docutils literal notranslate"><span class="pre">render_mode</span></code> argument is not working. Instead,
the <code class="docutils literal notranslate"><span class="pre">render</span></code> argument should be used.</p>
</div>
<p>Initialise a new MinitaurBulletCost environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_forward_velocity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The forward velocity that the
agent should try to track. Defaults to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p></li>
<li><p><strong>randomise_reference_forward_velocity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to randomize
the reference forward velocity. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>randomise_reference_forward_velocity_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>, </em><em>optional</em>) – The range of
the random reference forward velocity. Defaults to <code class="docutils literal notranslate"><span class="pre">(0.5,</span> <span class="pre">1.5)</span></code>.</p></li>
<li><p><strong>forward_velocity_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The weight used to scale the
forward velocity error. Defaults to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p></li>
<li><p><strong>include_energy_cost</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to include the energy cost in
the cost function (i.e. energy of the motors). Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>energy_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The weight used to scale the energy cost.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.005</span></code>.</p></li>
<li><p><strong>include_shake_cost</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to include the shake cost in
the cost function (i.e. moving up and down). Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>shake_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The weight used to scale the shake cost.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.01</span></code>.</p></li>
<li><p><strong>include_drift_cost</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to include the drift cost in
the cost function (i.e. movement in the y direction). Defaults to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>drift_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The weight used to scale the drift cost.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.01</span></code>.</p></li>
<li><p><strong>distance_limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The max distance (in meters) that the
agent can travel before the episode is terminated. Defaults to
<code class="docutils literal notranslate"><span class="pre">float(&quot;inf&quot;)</span></code>.</p></li>
<li><p><strong>render</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to render the environment. Defaults to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>include_health_penalty</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to penalize the Minitaur if
it becomes unhealthy (i.e. if it falls over). Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>health_penalty_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The size of the unhealthy penalty.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Meaning the penalty is equal to the max episode
steps and the steps taken.</p></li>
<li><p><strong>backward_velocity_bound</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The max backward velocity (in meters per
second) before the episode is terminated. Defaults to <code class="docutils literal notranslate"><span class="pre">-0.5</span></code>.</p></li>
<li><p><strong>fall_criteria_up_rotation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The max up rotation (in radians) between
the base and the world before the episode is terminated. Defaults to
<code class="docutils literal notranslate"><span class="pre">0.85</span></code>.</p></li>
<li><p><strong>fall_criteria_z_position</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The max z position (in meters) before the
episode is terminated. Defaults to <code class="docutils literal notranslate"><span class="pre">0.13</span></code>.</p></li>
<li><p><strong>exclude_reference_from_observation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether the reference
should be excluded from the observation. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>exclude_reference_error_from_observation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether the error
should be excluded from the observation. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>exclude_x_velocity_from_observation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to omit the
x- component of the velocity from observations. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>action_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type of the
action space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float32</span></code>.</p></li>
<li><p><strong>observation_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type
of the observation space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Extra keyword arguments to pass to the <code class="xref py py-class docutils literal notranslate"><span class="pre">MinitaurBulletEnv</span></code>
class.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.time_limit_max_episode_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_limit_max_episode_steps</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.time_limit_max_episode_steps" title="Permalink to this definition"></a></dt>
<dd><p>The maximum number of steps that the environment can take before it is
truncated by the <code class="xref py py-class docutils literal notranslate"><span class="pre">gymnasium.wrappers.TimeLimit</span></code> wrapper.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.base_velocity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_velocity</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.base_velocity" title="Permalink to this definition"></a></dt>
<dd><p>The base velocity of the minitaur.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.dt" title="Permalink to this definition"></a></dt>
<dd><p>The environment step size.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.tau">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.tau" title="Permalink to this definition"></a></dt>
<dd><p>Alias for the environment step size. Done for compatibility with the
other gymnasium environments.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.physics_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physics_time</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.physics_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns the physics time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Minitaur uses 100 steps to setup the system. This is why we add 100 time
steps.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.metadata" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shake_cost</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/minitaur/minitaur_bullet_cost/minitaur_bullet_cost.html#MinitaurBulletCost.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.cost" title="Permalink to this definition"></a></dt>
<dd><p>Compute the cost of a given base x velocity, energy cost, shake cost and
drift cost.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_velocity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The Minitaurs’s base x velocity.</p></li>
<li><p><strong>energy_cost</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The energy cost (i.e. motor cost).</p></li>
<li><p><strong>drift_cost</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The drift (y movement) cost.</p></li>
<li><p><strong>shake_cost</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The shake (z movement) cost.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>cost (float): The cost of the action.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Additional information about the cost.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/minitaur/minitaur_bullet_cost/minitaur_bullet_cost.html#MinitaurBulletCost.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.step" title="Permalink to this definition"></a></dt>
<dd><p>Take step into the environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method overrides the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code> method
such that the new cost function is used.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<em>np.ndarray</em>) – Action to take in the environment.</p></li>
<li><p><strong>render_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The render mode to use. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): Environment observation.</p></li>
<li><p>cost (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): Cost of the action.</p></li>
<li><p>terminated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode is terminated.</p></li>
<li><p>truncated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode was truncated. This
value is set by wrappers when for example a time limit is reached or
the agent goes out of bounds.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Additional information about the environment.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/minitaur/minitaur_bullet_cost/minitaur_bullet_cost.html#MinitaurBulletCost.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset gymnasium environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Initial environment observation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost._termination">
<span class="sig-name descname"><span class="pre">_termination</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/minitaur/minitaur_bullet_cost/minitaur_bullet_cost.html#MinitaurBulletCost._termination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost._termination" title="Permalink to this definition"></a></dt>
<dd><p>Check whether the episode is terminated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method overrides the <a class="reference internal" href="#stable_gym.envs.robotics.MinitaurBulletCost._termination" title="stable_gym.envs.robotics.MinitaurBulletCost._termination"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_termination()</span></code></a> method of the original
Minitaur environment so that we can also set a minimum velocity criteria.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean value that indicates whether the episode is terminated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.MinitaurBulletCost.is_fallen">
<span class="sig-name descname"><span class="pre">is_fallen</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/minitaur/minitaur_bullet_cost/minitaur_bullet_cost.html#MinitaurBulletCost.is_fallen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.MinitaurBulletCost.is_fallen" title="Permalink to this definition"></a></dt>
<dd><p>Check whether the minitaur has fallen.</p>
<p>If the up directions (i.e. angle) between the base and the world are larger
(the dot product is smaller than <code class="xref py py-attr docutils literal notranslate"><span class="pre">_fall_criteria_up_rotation</span></code>) or the
base is close to the ground (the height is smaller than
<code class="xref py py-attr docutils literal notranslate"><span class="pre">_fall_criteria_z_position</span></code>), the minitaur is considered fallen.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method overrides the <a class="reference internal" href="#stable_gym.envs.robotics.MinitaurBulletCost.is_fallen" title="stable_gym.envs.robotics.MinitaurBulletCost.is_fallen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_fallen()</span></code></a> method of the original
Minitaur environment to give users the ability to set the fall criteria.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean value that indicates whether the minitaur has fallen.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_gym.envs.robotics.</span></span><span class="sig-name descname"><span class="pre">QuadXHoverCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flight_dome_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_representation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'quaternion'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(480,</span> <span class="pre">480)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_health_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">health_penalty_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_hover_cost/quadx_hover_cost.html#QuadXHoverCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_hover_env.html#PyFlyt.gym_envs.quadx_envs.quadx_hover_env.QuadXHoverEnv" title="(in PyFlyt)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyFlyt.gym_envs.quadx_envs.quadx_hover_env.QuadXHoverEnv</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">gymnasium.utils.EzPickle</span></code></p>
<p>Custom QuadXHover Bullet gymnasium environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used in a vectorized manner. See the
<a class="reference external" href="https://gymnasium.farama.org/api/vector">gym.vector</a> documentation.</p>
</div>
<dl>
<dt>Source:</dt><dd><p>Modified version of the <a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_envs/quadx_hover_env.html">QuadXHover environment</a> found in the
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation">PyFlyt package</a>. This environment was first described by <a class="reference external" href="https://arxiv.org/abs/2304.01305">Tai et al. 2023</a>.
In this modified version:</p>
<ul class="simple">
<li><p>The reward has been changed to a cost. This was done by negating the reward always
to be positive definite.</p></li>
<li><p>A health penalty has been added. This penalty is applied when the quadrotor moves
outside the flight dome or crashes. The penalty equals the maximum episode steps
minus the steps taken or a user-defined penalty.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">max_duration_seconds</span></code> has been removed. Instead, the <code class="docutils literal notranslate"><span class="pre">max_episode_steps</span></code>
parameter of the <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.wrappers.TimeLimit</span></code> wrapper is used to limit
the episode duration.</p></li>
</ul>
<p>The rest of the environment is the same as the original QuadXHover environment.
Please refer to the <a class="reference external" href="https://github.com/jjshoots/PyFlyt">original codebase</a>,
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation">the PyFlyt documentation</a> or the accompanying
<a class="reference external" href="https://arxiv.org/abs/2304.01305">article of Tai et al. 2023</a> for more information.</p>
</dd>
</dl>
<dl>
<dt>Modified cost:</dt><dd><p>A cost, computed using the <a class="reference internal" href="#stable_gym.envs.robotics.QuadXHoverCost.cost" title="stable_gym.envs.robotics.QuadXHoverCost.cost"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadXHoverCost.cost()</span></code></a> method, is given for each
simulation step, including the terminal step. This cost is defined as the
Euclidean distance error between the quadrotors’ current position and a desired
hover position (i.e. <span class="math notranslate nohighlight">\(p=x_{x,y,z}=[0,0,1]\)</span>) and the error between the
quadrotors’ current angular roll and pitch and their zero values. A health penalty
can also be included in the cost. This health penalty is added when the drone
leaves the flight dome or crashes. It equals the <code class="docutils literal notranslate"><span class="pre">max_episode_steps</span></code> minus the
number of steps taken in the episode or a fixed value. The cost is computed as:</p>
<div class="math notranslate nohighlight">
\[cost = \| p_{drone} - p_{hover} \| + \| \theta_{roll,pitch} \| + p_{health}\]</div>
</dd>
<dt>Solved Requirements:</dt><dd><p>Considered solved when the average cost is less than or equal to 50 over
100 consecutive trials.</p>
</dd>
<dt>How to use:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stable_gym</span>
<span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;stable_gym:QuadXHoverCost-v1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.state">
<span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.state" title="Permalink to this definition"></a></dt>
<dd><p>The current system state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.agent_hz">
<span class="sig-name descname"><span class="pre">agent_hz</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.agent_hz" title="Permalink to this definition"></a></dt>
<dd><p>The agent looprate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.initial_physics_time">
<span class="sig-name descname"><span class="pre">initial_physics_time</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.initial_physics_time" title="Permalink to this definition"></a></dt>
<dd><p>The simulation startup time. The physics time at
the start of the episode after all the initialisation has been done.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<p>Initialise a new QuadXHoverCost environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flight_dome_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Size of the allowable flying area. By
default <code class="docutils literal notranslate"><span class="pre">3.0</span></code>.</p></li>
<li><p><strong>angle_representation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The angle representation to use.
Can be <code class="docutils literal notranslate"><span class="pre">&quot;euler&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;quaternion&quot;</span></code>. By default <code class="docutils literal notranslate"><span class="pre">&quot;quaternion&quot;</span></code>.</p></li>
<li><p><strong>agent_hz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Looprate of the agent to environment interaction.
By default <code class="docutils literal notranslate"><span class="pre">40</span></code>.</p></li>
<li><p><strong>render_mode</strong> (<em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The render mode. Can be <code class="docutils literal notranslate"><span class="pre">&quot;human&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">None</span></code>. By default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>render_resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The render resolution. By
default <code class="docutils literal notranslate"><span class="pre">(480,</span> <span class="pre">480)</span></code>.</p></li>
<li><p><strong>include_health_penalty</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to penalize the quadrotor
if it becomes unhealthy (i.e. if it falls over). Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>health_penalty_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The size of the unhealthy penalty.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Meaning the penalty is equal to the max episode
steps and the steps taken.</p></li>
<li><p><strong>action_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type of the
action space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>observation_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type
of the observation space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to the
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_hover_env.html#PyFlyt.gym_envs.quadx_envs.quadx_hover_env.QuadXHoverEnv" title="(in PyFlyt)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadXHoverEnv</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.time_limit_max_episode_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_limit_max_episode_steps</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.time_limit_max_episode_steps" title="Permalink to this definition"></a></dt>
<dd><p>The maximum number of steps that the environment can take before it is
truncated by the <code class="xref py py-class docutils literal notranslate"><span class="pre">gymnasium.wrappers.TimeLimit</span></code> wrapper.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.time_limit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_limit</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.time_limit" title="Permalink to this definition"></a></dt>
<dd><p>The maximum duration of the episode in seconds.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.dt" title="Permalink to this definition"></a></dt>
<dd><p>The environment step size.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The simulation step size. Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the environment is</dt><dd><p>not yet initialized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.tau">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.tau" title="Permalink to this definition"></a></dt>
<dd><p>Alias for the environment step size. Done for compatibility with the
other gymnasium environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The simulation step size. Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the environment is</dt><dd><p>not yet initialized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.t">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.t" title="Permalink to this definition"></a></dt>
<dd><p>Environment time.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.physics_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physics_time</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.physics_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns the physics time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_hover_cost/quadx_hover_cost.html#QuadXHoverCost.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.cost" title="Permalink to this definition"></a></dt>
<dd><p>Compute the cost of the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>cost (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): The cost.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Dictionary containing additional information
about the cost.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_hover_cost/quadx_hover_cost.html#QuadXHoverCost.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.step" title="Permalink to this definition"></a></dt>
<dd><p>Take step into the environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method overrides the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code>
method such that the new cost function is used.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>np.ndarray</em>) – Action to take in the environment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): Environment observation.</p></li>
<li><p>cost (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): Cost of the action.</p></li>
<li><p>terminated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode is terminated.</p></li>
<li><p>truncated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode was truncated. This
value is set by wrappers when for example a time limit is reached
or the agent goes out of bounds.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Additional information about the environment.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXHoverCost.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_hover_cost/quadx_hover_cost.html#QuadXHoverCost.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXHoverCost.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset gymnasium environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – A random seed for the environment. By default
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary containing additional options for
resetting the environment. By default <code class="docutils literal notranslate"><span class="pre">None</span></code>. Not used in this
environment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>): Initial environment observation.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Dictionary containing additional information.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_gym.envs.robotics.</span></span><span class="sig-name descname"><span class="pre">QuadXTrackingCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flight_dome_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_representation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'quaternion'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(480,</span> <span class="pre">480)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_target_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">1.0,</span> <span class="pre">0.25)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_phase_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">-np.pi</span> <span class="pre">/</span> <span class="pre">2.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_health_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">health_penalty_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_reference_from_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_reference_error_from_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_tracking_cost/quadx_tracking_cost.html#QuadXTrackingCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_hover_env.html#PyFlyt.gym_envs.quadx_envs.quadx_hover_env.QuadXHoverEnv" title="(in PyFlyt)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyFlyt.gym_envs.quadx_envs.quadx_hover_env.QuadXHoverEnv</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">gymnasium.utils.EzPickle</span></code></p>
<p>Custom QuadX Bullet gymnasium environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used in a vectorized manner. See the
<a class="reference external" href="https://gymnasium.farama.org/api/vector">gym.vector</a> documentation.</p>
</div>
<dl>
<dt>Source:</dt><dd><p>Modified version of the <a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_envs/quadx_hover_env.html">QuadXHover environment</a> found in the
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation">PyFlyt package</a>. Compared to the original environment:</p>
<ul class="simple">
<li><p>The reward has been changed to a cost. This was done by negating the reward always
to be positive definite.</p></li>
<li><p>A health penalty has been added. This penalty is applied when the quadrotor moves
outside the flight dome or crashes. The penalty equals the maximum episode steps
minus the steps taken or a user-defined penalty.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">max_duration_seconds</span></code> has been removed. Instead, the <code class="docutils literal notranslate"><span class="pre">max_episode_steps</span></code>
parameter of the <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.wrappers.TimeLimit</span></code> wrapper is used to limit
the episode duration.</p></li>
<li><p>The objective has been changed to track a periodic reference trajectory.</p></li>
<li><p>The info dictionary has been extended with the reference, state of interest
(i.e. the state to track) and reference error.</p></li>
</ul>
<p>The rest of the environment is the same as the original QuadXHover environment.
Please refer to the <a class="reference external" href="https://github.com/jjshoots/PyFlyt">original codebase</a>,
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation">the PyFlyt documentation</a> or the accompanying
<a class="reference external" href="https://arxiv.org/abs/2304.01305">article of Tai et al. 2023</a> for more information.</p>
</dd>
</dl>
<dl>
<dt>Modified cost:</dt><dd><p>A cost, computed using the <a class="reference internal" href="#stable_gym.envs.robotics.QuadXTrackingCost.cost" title="stable_gym.envs.robotics.QuadXTrackingCost.cost"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadXTrackingCost.cost()</span></code></a> method, is given for each
simulation step, including the terminal step. This cost is defined as the
Euclidean distance error between the quadrotors’ current position and a desired
reference position (i.e. <span class="math notranslate nohighlight">\(p=x_{x,y,z}=[0,0,1]\)</span>). A health penalty
can also be included in the cost. This health penalty is added when the drone
leaves the flight dome or crashes. It equals the <code class="docutils literal notranslate"><span class="pre">max_episode_steps</span></code> minus the
number of steps taken in the episode or a fixed value. The cost is computed as:</p>
<div class="math notranslate nohighlight">
\[cost = \| p_{drone} - p_{reference} \| + p_{health}\]</div>
</dd>
<dt>Solved Requirements:</dt><dd><p>Considered solved when the average cost is less than or equal to 50 over
100 consecutive trials.</p>
</dd>
<dt>How to use:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stable_gym</span>
<span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;stable_gym:QuadXTrackingCost-v1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.state">
<span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.state" title="Permalink to this definition"></a></dt>
<dd><p>The current system state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.agent_hz">
<span class="sig-name descname"><span class="pre">agent_hz</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.agent_hz" title="Permalink to this definition"></a></dt>
<dd><p>The agent looprate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.initial_physics_time">
<span class="sig-name descname"><span class="pre">initial_physics_time</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.initial_physics_time" title="Permalink to this definition"></a></dt>
<dd><p>The simulation startup time. The physics time at
the start of the episode after all the initialisation has been done.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<p>Initialise a new QuadXTrackingCost environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flight_dome_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Size of the allowable flying area. By
default <code class="docutils literal notranslate"><span class="pre">3.0</span></code>.</p></li>
<li><p><strong>angle_representation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The angle representation to use.
Can be <code class="docutils literal notranslate"><span class="pre">&quot;euler&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;quaternion&quot;</span></code>. By default <code class="docutils literal notranslate"><span class="pre">&quot;quaternion&quot;</span></code>.</p></li>
<li><p><strong>agent_hz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Looprate of the agent to environment interaction.
By default <code class="docutils literal notranslate"><span class="pre">40</span></code>.</p></li>
<li><p><strong>render_mode</strong> (<em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The render mode. Can be <code class="docutils literal notranslate"><span class="pre">&quot;human&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">None</span></code>. By default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>render_resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The render resolution. By
default <code class="docutils literal notranslate"><span class="pre">(480,</span> <span class="pre">480)</span></code>.</p></li>
<li><p><strong>reference_target_position</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The
target position of the reference. Defaults to <code class="docutils literal notranslate"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0)</span></code>.</p></li>
<li><p><strong>reference_amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The amplitude
of the reference. Defaults to <code class="docutils literal notranslate"><span class="pre">(1.0,</span> <span class="pre">1.0,</span> <span class="pre">0.25)</span></code>.</p></li>
<li><p><strong>reference_frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The frequency
of the reference. Defaults to <code class="docutils literal notranslate"><span class="pre">(0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.10)</span></code>.</p></li>
<li><p><strong>reference_phase_shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The phase
shift of the reference. Defaults to <code class="docutils literal notranslate"><span class="pre">(0.0,</span> <span class="pre">-np.pi</span> <span class="pre">/</span> <span class="pre">2,</span> <span class="pre">0.0)</span></code>.</p></li>
<li><p><strong>include_health_penalty</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to penalize the quadrotor
if it becomes unhealthy (i.e. if it falls over). Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>health_penalty_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The size of the unhealthy penalty.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Meaning the penalty is equal to the max episode
steps and the steps taken.</p></li>
<li><p><strong>exclude_reference_from_observation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether the reference
should be excluded from the observation. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>exclude_reference_error_from_observation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether the error
should be excluded from the observation. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>action_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type of the
action space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>observation_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type
of the observation space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to the
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_hover_env.html#PyFlyt.gym_envs.quadx_envs.quadx_hover_env.QuadXHoverEnv" title="(in PyFlyt)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadXHoverEnv</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.time_limit_max_episode_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_limit_max_episode_steps</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.time_limit_max_episode_steps" title="Permalink to this definition"></a></dt>
<dd><p>The maximum number of steps that the environment can take before it is
truncated by the <code class="xref py py-class docutils literal notranslate"><span class="pre">gymnasium.wrappers.TimeLimit</span></code> wrapper.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.time_limit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_limit</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.time_limit" title="Permalink to this definition"></a></dt>
<dd><p>The maximum duration of the episode in seconds.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.dt" title="Permalink to this definition"></a></dt>
<dd><p>The environment step size.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The simulation step size. Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the environment is</dt><dd><p>not yet initialized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.tau">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.tau" title="Permalink to this definition"></a></dt>
<dd><p>Alias for the environment step size. Done for compatibility with the
other gymnasium environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The simulation step size. Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the environment is</dt><dd><p>not yet initialized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.t">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.t" title="Permalink to this definition"></a></dt>
<dd><p>Environment time.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.physics_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physics_time</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.physics_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns the physics time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.reference">
<span class="sig-name descname"><span class="pre">reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_tracking_cost/quadx_tracking_cost.html#QuadXTrackingCost.reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.reference" title="Permalink to this definition"></a></dt>
<dd><p>Returns the current value of the (periodic) drone (x, y, z) reference
position that should be tracked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The current time step.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The current reference position.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_tracking_cost/quadx_tracking_cost.html#QuadXTrackingCost.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.cost" title="Permalink to this definition"></a></dt>
<dd><p>Compute the cost of the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The cost.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_tracking_cost/quadx_tracking_cost.html#QuadXTrackingCost.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.step" title="Permalink to this definition"></a></dt>
<dd><p>Take step into the environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method overrides the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code>
method such that the new cost function is used.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>np.ndarray</em>) – Action to take in the environment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): Environment observation.</p></li>
<li><p>cost (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): Cost of the action.</p></li>
<li><p>terminated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode is terminated.</p></li>
<li><p>truncated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode was truncated. This
value is set by wrappers when for example a time limit is reached
or the agent goes out of bounds.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Additional information about the environment.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_tracking_cost/quadx_tracking_cost.html#QuadXTrackingCost.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset gymnasium environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – A random seed for the environment. By default
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary containing additional options for
resetting the environment. By default <code class="docutils literal notranslate"><span class="pre">None</span></code>. Not used in this
environment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>): Initial environment observation.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Dictionary containing additional information.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXTrackingCost.visualize_reference">
<span class="sig-name descname"><span class="pre">visualize_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_tracking_cost/quadx_tracking_cost.html#QuadXTrackingCost.visualize_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXTrackingCost.visualize_reference" title="Permalink to this definition"></a></dt>
<dd><p>Visualize the reference target.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_gym.envs.robotics.</span></span><span class="sig-name descname"><span class="pre">QuadXWaypointsCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_yaw_targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_reach_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_reach_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flight_dome_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_representation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'quaternion'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(480,</span> <span class="pre">480)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_health_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">health_penalty_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_waypoint_targets_from_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_observe_immediate_waypoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_waypoint_target_deltas_from_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_observe_immediate_waypoint_target_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_space_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_waypoints_cost/quadx_waypoints_cost.html#QuadXWaypointsCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_waypoints_env.html#PyFlyt.gym_envs.quadx_envs.quadx_waypoints_env.QuadXWaypointsEnv" title="(in PyFlyt)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyFlyt.gym_envs.quadx_envs.quadx_waypoints_env.QuadXWaypointsEnv</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">gymnasium.utils.EzPickle</span></code></p>
<p>Custom QuadXWaypoints Bullet gymnasium environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used in a vectorized manner. See the
<a class="reference external" href="https://gymnasium.farama.org/api/vector">gym.vector</a> documentation.</p>
</div>
<dl>
<dt>Source:</dt><dd><p>Modified version of the <a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_envs/quadx_waypoints_env.html">QuadXWaypoints environment</a> found in the
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation">PyFlyt package</a>. This environment was first described by <a class="reference external" href="https://arxiv.org/abs/2304.01305">Tai et al. 2023</a>.
In this modified version:</p>
<ul class="simple">
<li><p>The reward has been changed to a cost. This was done by negating the reward always
to be positive definite.</p></li>
<li><p>A health penalty has been added. This penalty is applied when the quadrotor moves
outside the flight dome or crashes. The penalty equals the maximum episode steps
minus the steps taken or a user-defined penalty.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">max_duration_seconds</span></code> has been removed. Instead, the <code class="docutils literal notranslate"><span class="pre">max_episode_steps</span></code>
parameter of the <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.wrappers.TimeLimit</span></code> wrapper is used to limit
the episode duration.</p></li>
</ul>
<p>The rest of the environment is the same as the original QuadXWaypoints environment.
Please refer to the <a class="reference external" href="https://github.com/jjshoots/PyFlyt">original codebase</a>,
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation">the PyFlyt documentation</a> or the accompanying
<a class="reference external" href="https://arxiv.org/abs/2304.01305">article of Tai et al. 2023</a> for more information.</p>
</dd>
</dl>
<dl>
<dt>Modified cost:</dt><dd><p>A cost, computed using the <a class="reference internal" href="#stable_gym.envs.robotics.QuadXWaypointsCost.cost" title="stable_gym.envs.robotics.QuadXWaypointsCost.cost"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadXWaypointsCost.cost()</span></code></a> method, is given for each
simulation step, including the terminal step. This cost is defined as the Euclidean
error between the quadrotors’ current position and the position of the current
waypoint (i.e. <span class="math notranslate nohighlight">\(p=x_{x,y,z}=[0,0,1]\)</span>). Additionally, a penalty is
given for moving away from the waypoint, and a health penalty can also
be included in the cost. This health penalty is added when the drone leaves the
flight dome or crashes. It equals the <code class="docutils literal notranslate"><span class="pre">max_episode_steps</span></code> minus the
number of steps taken in the episode or a fixed value. The cost is
computed as:</p>
<div class="math notranslate nohighlight">
\[cost = 10 \times \| p_{drone} - p_{waypoint} \| - \min(3.0 \times (p_{old} - p_{drone}), 0.0) + p_{health}\]</div>
</dd>
<dt>Solved Requirements:</dt><dd><p>Considered solved when the average cost is less than or equal to 50 over
100 consecutive trials.</p>
</dd>
<dt>How to use:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stable_gym</span>
<span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;stable_gym:QuadXWaypointsCost-v1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.state">
<span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.state" title="Permalink to this definition"></a></dt>
<dd><p>The current system state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.agent_hz">
<span class="sig-name descname"><span class="pre">agent_hz</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.agent_hz" title="Permalink to this definition"></a></dt>
<dd><p>The agent looprate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.initial_physics_time">
<span class="sig-name descname"><span class="pre">initial_physics_time</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.initial_physics_time" title="Permalink to this definition"></a></dt>
<dd><p>The simulation startup time. The physics time at
the start of the episode after all the initialisation has been done.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<p>Initialise a new QuadXWaypointsCost environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of waypoints in the environment. By
default <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p></li>
<li><p><strong>use_yaw_targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to match yaw targets before a
waypoint is considered reached. By default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>goal_reach_distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Distance to the waypoints for it to
be considered reached. By default <code class="docutils literal notranslate"><span class="pre">0.2</span></code>.</p></li>
<li><p><strong>goal_reach_angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Angle in radians to the waypoints for
it to be considered reached, only in effect if <code class="docutils literal notranslate"><span class="pre">use_yaw_targets</span></code> is
used. By default <code class="docutils literal notranslate"><span class="pre">0.1</span></code>.</p></li>
<li><p><strong>flight_dome_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Size of the allowable flying area. By
default <code class="docutils literal notranslate"><span class="pre">5.0</span></code>.</p></li>
<li><p><strong>angle_representation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The angle representation to use.
Can be <code class="docutils literal notranslate"><span class="pre">&quot;euler&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;quaternion&quot;</span></code>. By default <code class="docutils literal notranslate"><span class="pre">&quot;quaternion&quot;</span></code>.</p></li>
<li><p><strong>agent_hz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Looprate of the agent to environment interaction.
By default <code class="docutils literal notranslate"><span class="pre">30</span></code>.</p></li>
<li><p><strong>render_mode</strong> (<em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The render mode. Can be <code class="docutils literal notranslate"><span class="pre">&quot;human&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">None</span></code>. By default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>render_resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The render resolution. By
default <code class="docutils literal notranslate"><span class="pre">(480,</span> <span class="pre">480)</span></code>.</p></li>
<li><p><strong>include_health_penalty</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to penalize the quadrotor
if it becomes unhealthy (i.e. if it falls over). Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>health_penalty_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The size of the unhealthy penalty.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Meaning the penalty is equal to the max episode
steps and the steps taken.</p></li>
<li><p><strong>exclude_waypoint_targets_from_observation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to
exclude the waypoint targets from the observation. Defaults to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>only_observe_immediate_waypoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to only observe
the immediate waypoint target. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>exclude_waypoint_target_deltas_from_observation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether
to exclude the waypoint target deltas from the observation. Defaults to
<code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>only_observe_immediate_waypoint_target_delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to
only observe the immediate waypoint target delta. Defaults to
<code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>action_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type of the
action space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>observation_space_dtype</strong> (<em>union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><em>numpy.dtype</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – The data type
of the observation space. Defaults to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to the
<a class="reference external" href="https://jjshoots.github.io/PyFlyt/documentation/gym_envs/quadx_waypoints_env.html#PyFlyt.gym_envs.quadx_envs.quadx_waypoints_env.QuadXWaypointsEnv" title="(in PyFlyt)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadXWaypointsEnv</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.immediate_waypoint_target">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">immediate_waypoint_target</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.immediate_waypoint_target" title="Permalink to this definition"></a></dt>
<dd><p>The immediate waypoint target.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.time_limit_max_episode_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_limit_max_episode_steps</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.time_limit_max_episode_steps" title="Permalink to this definition"></a></dt>
<dd><p>The maximum number of steps that the environment can take before it is
truncated by the <code class="xref py py-class docutils literal notranslate"><span class="pre">gymnasium.wrappers.TimeLimit</span></code> wrapper.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.time_limit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_limit</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.time_limit" title="Permalink to this definition"></a></dt>
<dd><p>The maximum duration of the episode in seconds.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.dt" title="Permalink to this definition"></a></dt>
<dd><p>The environment step size.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The simulation step size. Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the environment is</dt><dd><p>not yet initialized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.tau">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.tau" title="Permalink to this definition"></a></dt>
<dd><p>Alias for the environment step size. Done for compatibility with the
other gymnasium environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The simulation step size. Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the environment is</dt><dd><p>not yet initialized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.t">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.t" title="Permalink to this definition"></a></dt>
<dd><p>Environment time.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.physics_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physics_time</span></span><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.physics_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns the physics time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_completed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_targets_reached</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_waypoints_cost/quadx_waypoints_cost.html#QuadXWaypointsCost.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.cost" title="Permalink to this definition"></a></dt>
<dd><p>Compute the cost of the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_completed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Whether the environment is completed.</p></li>
<li><p><strong>num_targets_reached</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of targets reached.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>cost (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): The cost of the current state.</p></li>
<li><dl class="simple">
<dt>cost_info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Dictionary containing additional cost</dt><dd><p>information.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.compute_target_deltas">
<span class="sig-name descname"><span class="pre">compute_target_deltas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ang_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quarternion</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_waypoints_cost/quadx_waypoints_cost.html#QuadXWaypointsCost.compute_target_deltas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.compute_target_deltas" title="Permalink to this definition"></a></dt>
<dd><p>Compute the waypoints target deltas.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Needed because the <cite>~PyFlyt.gym_envs.quadx_envs.quadx_waypoints_env.QuadXWaypointsEnv</cite>
removes the immediate waypoint from the waypoint targets list when it is
reached and doesn’t expose the old value.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ang_pos</strong> (<em>np.ndarray</em>) – The current angular position.</p></li>
<li><p><strong>lin_pos</strong> (<em>np.ndarray</em>) – The current position.</p></li>
<li><p><strong>quarternion</strong> (<em>np.ndarray</em>) – The current quarternion.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The waypoints target deltas.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_waypoints_cost/quadx_waypoints_cost.html#QuadXWaypointsCost.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.step" title="Permalink to this definition"></a></dt>
<dd><p>Take step into the environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method overrides the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code>
method such that the new cost function is used.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>np.ndarray</em>) – Action to take in the environment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): Environment observation.</p></li>
<li><p>cost (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): Cost of the action.</p></li>
<li><p>terminated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode is terminated.</p></li>
<li><p>truncated (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>): Whether the episode was truncated. This
value is set by wrappers when for example a time limit is reached
or the agent goes out of bounds.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Additional information about the environment.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_gym.envs.robotics.QuadXWaypointsCost.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/stable_gym/envs/robotics/quadrotor/quadx_waypoints_cost/quadx_waypoints_cost.html#QuadXWaypointsCost.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_gym.envs.robotics.QuadXWaypointsCost.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset gymnasium environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – A random seed for the environment. By default
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary containing additional options for
resetting the environment. By default <code class="docutils literal notranslate"><span class="pre">None</span></code>. Not used in this
environment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>obs (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>): Initial environment observation.</p></li>
<li><p>info (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>): Dictionary containing additional information.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../mujoco/walker2d_cost/walker2d_cost/index.html" class="btn btn-neutral float-left" title="stable_gym.envs.mujoco.walker2d_cost.walker2d_cost" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fetch/index.html" class="btn btn-neutral float-right" title="stable_gym.envs.robotics.fetch" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Rick Staa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>